"use strict";(self.webpackChunkvuexy=self.webpackChunkvuexy||[]).push([[9697],{9010:function(P,v,s){s.d(v,{q:function(){return x}});var f=s(5134),C=s(7289),T=s(4522),A=s(8260),q=s(540),i=s(2047),e=s(6154),x=function(){var h=function(){function Z(d){(0,f.Z)(this,Z),this._http=d,this.wareData={data:""},this.host=A.N.apiUrl+"/api/warehouses/",this.header=new T.WM({Accept:"application/json"}),this.params=new T.LE}return(0,C.Z)(Z,[{key:"AddWare",value:function(p){return this._http.post("".concat(this.host),p,{headers:this.header}).pipe((0,i.K)(function(g){return console.log(g),(0,q._)(g)}))}},{key:"allware",value:function(){return this._http.get("".concat(this.host),{headers:this.header,params:this.params})}},{key:"deleteWare",value:function(p){return this._http.delete("".concat(this.host).concat(p))}},{key:"updateWare",value:function(p,g){return this._http.patch("".concat(this.host).concat(p),g)}},{key:"getWareid",value:function(p){return this._http.get("".concat(this.host).concat(p))}}]),Z}();return h.\u0275fac=function(d){return new(d||h)(e.LFG(T.eN))},h.\u0275prov=e.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h}()},9697:function(P,v,s){s.r(v),s.d(v,{CreatepurchasesModule:function(){return R}});var f=s(7289),C=s(5134),T=s(3907),A=s(9753),q=s(1705),i=s(9133),e=s(6154),x=s(9010),h=s(1285),Z=s(1948),d=s(8452),p=s(3797),g=s(6019),b=s(9850),U=s(6533);function O(o,a){1&o&&(e.TgZ(0,"small"),e._uU(1," This field is required "),e.qZA())}function y(o,a){if(1&o&&(e.TgZ(0,"div",39),e.YNc(1,O,2,0,"small",8),e.qZA()),2&o){var r=e.oxw();e.xp6(1),e.Q6J("ngIf",null==r.createPurchForm.controls.date.errors?null:r.createPurchForm.controls.date.errors.required)}}function M(o,a){if(1&o&&(e.TgZ(0,"small"),e._uU(1),e.qZA()),2&o){var r=e.oxw();e.xp6(1),e.Oqu(null==r.errors?null:r.errors.date)}}function N(o,a){if(1&o&&(e.TgZ(0,"option",40),e._uU(1),e.qZA()),2&o){var r=a.$implicit;e.Q6J("value",r.id),e.xp6(1),e.hij(" ",r.name," ")}}function w(o,a){1&o&&(e.TgZ(0,"small"),e._uU(1," This field is required "),e.qZA())}function F(o,a){if(1&o&&(e.TgZ(0,"div",39),e.YNc(1,w,2,0,"small",8),e.qZA()),2&o){var r=e.oxw();e.xp6(1),e.Q6J("ngIf",null==r.createPurchForm.controls.supplier_id.errors?null:r.createPurchForm.controls.supplier_id.errors.required)}}function I(o,a){if(1&o&&(e.TgZ(0,"small"),e._uU(1),e.qZA()),2&o){var r=e.oxw();e.xp6(1),e.Oqu(null==r.errors?null:r.errors.supplier_id)}}function S(o,a){if(1&o&&(e.TgZ(0,"option",40),e._uU(1),e.qZA()),2&o){var r=a.$implicit;e.Q6J("value",r.id),e.xp6(1),e.hij(" ",r.name," ")}}function J(o,a){1&o&&(e.TgZ(0,"small"),e._uU(1," This field is required "),e.qZA())}function D(o,a){if(1&o&&(e.TgZ(0,"div",39),e.YNc(1,J,2,0,"small",8),e.qZA()),2&o){var r=e.oxw();e.xp6(1),e.Q6J("ngIf",null==r.createPurchForm.controls.warehouse_id.errors?null:r.createPurchForm.controls.warehouse_id.errors.required)}}function E(o,a){if(1&o&&(e.TgZ(0,"small"),e._uU(1),e.qZA()),2&o){var r=e.oxw();e.xp6(1),e.Oqu(null==r.errors?null:r.errors.warehouse_id)}}function k(o,a){if(1&o){var r=e.EpF();e.TgZ(0,"li",41),e.NdJ("click",function(){var l=e.CHM(r).index;return e.oxw().addPurchDetail(l)}),e._uU(1),e.qZA()}if(2&o){var t=a.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function Q(o,a){if(1&o){var r=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e.TgZ(8,"core-touchspin",42),e.NdJ("onChange",function(c){var _=e.CHM(r).index;return e.oxw().countChange(c,_)}),e.qZA(),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e.TgZ(14,"div",37),e.TgZ(15,"button",43),e.NdJ("click",function(){var m=e.CHM(r).index;return e.oxw().removePurchDetail(m)}),e._UZ(16,"i",44),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&o){var t=a.$implicit,n=a.index,u=e.oxw();e.xp6(2),e.Oqu(n+1),e.xp6(2),e.Oqu(t.product.name),e.xp6(2),e.Oqu(t.product.cost),e.xp6(2),e.Q6J("minValue",1)("numberValue",t.quantity),e.xp6(2),e.Oqu(u.countTax(t.quantity,t.product.tax_cost)),e.xp6(2),e.Oqu(t.total),e.xp6(4),e.Q6J("size",24)}}function Y(o,a){if(1&o&&(e.TgZ(0,"small"),e._uU(1),e.qZA()),2&o){var r=e.oxw();e.xp6(1),e.Oqu(null==r.errors?null:r.errors.tax_rate)}}function W(o,a){if(1&o&&(e.TgZ(0,"small"),e._uU(1),e.qZA()),2&o){var r=e.oxw();e.xp6(1),e.Oqu(null==r.errors?null:r.errors.discount)}}function G(o,a){if(1&o&&(e.TgZ(0,"small"),e._uU(1),e.qZA()),2&o){var r=e.oxw();e.xp6(1),e.Oqu(null==r.errors?null:r.errors.shipping)}}var j=function(){return{standalone:!0}},B=function(){var o=function(){function a(r,t,n,u,l){(0,C.Z)(this,a),this._warehouseService=r,this._supplierService=t,this._productSearchService=n,this._toastr=u,this._purchaseService=l,this.searchInput="",this.submitted=!1,this.errors={},this.orderTax=0,this.discount=0,this.shipping=0,this.total=0,this.grandTotal=0,this.wannaPass=!1,this.purchDetails=[],this.createPurchForm=new i.cw({date:new i.NI("",i.kI.required),supplier_id:new i.NI(null,i.kI.required),warehouse_id:new i.NI(null,i.kI.required),shipping:new i.NI(0),tax_rate:new i.NI(0),discount:new i.NI(0),status:new i.NI("PAID"),notes:new i.NI("")})}return(0,f.Z)(a,[{key:"ngOnInit",value:function(){var t=this;this._warehouseService.allware().subscribe({next:function(u){t.warehouses=u.data}}),this._supplierService.allSupplier().subscribe({next:function(u){t.suppliers=u.data}})}},{key:"purchaseSearch",value:function(t){var n=this;this._productSearchService.purchaseSearch(t).subscribe({next:function(l){n.products=l.data},error:function(l){n._toastr.error("Something wrong with product search!")}})}},{key:"addPurchDetail",value:function(t){var n=this;if(this.checkProductExist(this.purchDetails,this.products[t])){var l=this.purchDetails.findIndex(function(m){return m.product===n.products[t]}),c=this.purchDetails[l];c.quantity++,c.total=this.countSubTotal(c.quantity,c.product.tax_cost,c.product.cost)}else{var u={product_id:this.products[t].id,quantity:1,purchase_unit_id:this.products[t].unitPurchase.id,cost:this.products[t].total_cost,total:this.countSubTotal(1,this.products[t].tax_cost,this.products[t].cost),TaxNet:this.products[t].tax_percent,tax_method:this.products[t].tax_method,product:this.products[t]};this.purchDetails.push(u)}this.countTotal(),this.countGrandTotal()}},{key:"removePurchDetail",value:function(t){this.purchDetails.splice(t,1),this.countTotal(),this.countGrandTotal()}},{key:"checkProductExist",value:function(t,n){return t.find(function(u){return u.product.id===n.id})}},{key:"countChange",value:function(t,n){this.purchDetails[n].quantity=t,this.purchDetails[n].total=this.countSubTotal(this.purchDetails[n].quantity,this.purchDetails[n].product.tax_cost,this.purchDetails[n].product.cost),this.countTotal(),this.countGrandTotal()}},{key:"countTax",value:function(t,n){return t*n}},{key:"countSubTotal",value:function(t,n,u){return t*u+this.countTax(t,n)}},{key:"countOrderTax",value:function(){this.orderTax=this.total/100*this.createPurchForm.value.tax_rate}},{key:"countDiscount",value:function(){this.discount=this.createPurchForm.value.discount}},{key:"countShipping",value:function(){this.shipping=this.createPurchForm.value.shipping}},{key:"countGrandTotal",value:function(){this.grandTotal=+this.total+ +this.orderTax+ +this.shipping-+this.discount}},{key:"countTotal",value:function(){var t=this;this.total=0,this.purchDetails.forEach(function(n){t.total+=n.total}),this.countOrderTax(),this.countDiscount(),this.countShipping()}},{key:"storePurch",value:function(){var t=this;if(this.submitted=!0,0!=this.purchDetails.length){if(this.createPurchForm.valid&&this.wannaPass){var n=this.createPurchForm.value,u=JSON.parse(localStorage.getItem("currentUser")),l={date:n.date,discount:n.discount,tax_rate:n.tax_rate,notes:n.notes,shipping:n.shipping,status:n.status,GrandTotal:this.grandTotal,paid_amount:0,warehouse_id:n.warehouse_id,provider_id:n.supplier_id,user_id:u.id,purchaseDetails:this.purchDetails};console.log(l);var c={next:function(_){t._toastr.success("New purchase has been added"),t.purchDetails=[],t.createPurchForm.reset(),t.countGrandTotal()},error:function(_){t.errors=_.error.errors,t._toastr.error("Make sure for your data!")}};this._purchaseService.store(l).subscribe(c)}}else this._toastr.error("please choase product!","Error")}},{key:"passMe",value:function(){this.wannaPass=!0}}]),a}();return o.\u0275fac=function(r){return new(r||o)(e.Y36(x.q),e.Y36(h.k),e.Y36(Z.j),e.Y36(d._W),e.Y36(p.B))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-createpurchases"]],decls:126,vars:23,consts:[["action","",3,"formGroup","ngSubmit"],[1,"col-md-12","row"],[1,"form-group","col-md-4"],["for","category",1,"col-md-4","control-label"],[1,"col-md-12"],["formControlName","date","type","date","placeholder","Date","aria-label","Date",1,"form-control","form-control","col-md-11"],["id","","class","form-text text-danger",4,"ngIf"],[1,"form-text","text-danger"],[4,"ngIf"],["for","supplier",1,"col-md-8","control-label"],["aria-label","Default select example","formControlName","supplier_id",1,"form-select","col-md-12"],["selected",""],[3,"value",4,"ngFor","ngForOf"],["for","category",1,"col-md-8","control-label"],["aria-label","Default select example","formControlName","warehouse_id",1,"form-select","col-md-12"],["for","product",1,"col-md-4","control-label"],[1,"col-md-12","mb-1","row","panel","panel-primary"],[1,"switch-icon-left","col-md-1"],["data-feather","search",3,"size"],["type","text","placeholder","Search By product name or variants","aria-label","Search",1,"form-control","col-md-11","text-left",3,"ngModel","ngModelOptions","ngModelChange"],[1,"col-md-12","list-group"],["class","list-group-item","style","list-style: none; cursor: pointer;",3,"click",4,"ngFor","ngForOf"],[1,"table","col-md-11"],["scope","col"],[1,"table-group-divider"],[4,"ngFor","ngForOf"],[1,"table","col-md-4","tab"],["for","ordertax",1,"col-md-8","control-label"],["id","ordertax","formControlName","tax_rate","placeholder","0","required","","type","number",1,"form-control","input-md",3,"ngModelChange"],["id","ordertax","formControlName","discount","placeholder","0","required","","type","number",1,"form-control","input-md",3,"ngModelChange"],["id","ordertax","formControlName","shipping","placeholder","0","required","","type","number",1,"form-control","input-md",3,"ngModelChange"],["for","status",1,"col-md-8","control-label"],["aria-label","Default select example","formControlName","status",1,"form-select","col-md-12"],[1,"container"],[1,"form-group","col-md-12"],["for","exampleFormControlTextarea1",1,"form-label"],["id","exampleFormControlTextarea1","rows","3","formControlName","notes",1,"form-control"],[1,"col-md-4"],["id","singlebutton","name","singlebutton",1,"btn","btn-primary",3,"click"],["id","",1,"form-text","text-danger"],[3,"value"],[1,"list-group-item",2,"list-style","none","cursor","pointer",3,"click"],[3,"minValue","numberValue","onChange"],[1,"btn","btn-sm","btn-danger",3,"click"],["data-feather","x-circle",3,"size"]],template:function(r,t){1&r&&(e.TgZ(0,"body"),e.TgZ(1,"h2"),e._uU(2,"Create Purchase "),e.qZA(),e._UZ(3,"hr"),e.TgZ(4,"form",0),e.NdJ("ngSubmit",function(){return t.storePurch()}),e.TgZ(5,"div",1),e.TgZ(6,"div",2),e.TgZ(7,"label",3),e._uU(8,"Date"),e.qZA(),e.TgZ(9,"div",4),e._UZ(10,"input",5),e.YNc(11,y,2,1,"div",6),e.TgZ(12,"div",7),e.YNc(13,M,2,1,"small",8),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div",2),e.TgZ(15,"label",9),e._uU(16,"Supplier"),e.qZA(),e.TgZ(17,"div",4),e.TgZ(18,"select",10),e.TgZ(19,"option",11),e._uU(20,"Choose Supplier"),e.qZA(),e.YNc(21,N,2,2,"option",12),e.qZA(),e.YNc(22,F,2,1,"div",6),e.TgZ(23,"div",7),e.YNc(24,I,2,1,"small",8),e.qZA(),e.qZA(),e.qZA(),e.TgZ(25,"div",2),e.TgZ(26,"label",13),e._uU(27," Warehouse"),e.qZA(),e.TgZ(28,"div",4),e.TgZ(29,"select",14),e.TgZ(30,"option",11),e._uU(31,"Choose Warehouse"),e.qZA(),e.YNc(32,S,2,2,"option",12),e.qZA(),e.YNc(33,D,2,1,"div",6),e.TgZ(34,"div",7),e.YNc(35,E,2,1,"small",8),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(36,"div",4),e.TgZ(37,"label",15),e._uU(38,"Product"),e.qZA(),e.TgZ(39,"form",16),e.TgZ(40,"span",17),e._UZ(41,"i",18),e.qZA(),e.TgZ(42,"input",19),e.NdJ("ngModelChange",function(u){return t.purchaseSearch(u)}),e.qZA(),e.TgZ(43,"div",20),e.TgZ(44,"ul",4),e.YNc(45,k,2,1,"li",21),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(46,"h4"),e._uU(47,"Order items"),e.qZA(),e.TgZ(48,"table",22),e.TgZ(49,"thead"),e.TgZ(50,"tr"),e.TgZ(51,"th",23),e._uU(52,"#"),e.qZA(),e.TgZ(53,"th",23),e._uU(54,"Product"),e.qZA(),e.TgZ(55,"th",23),e._uU(56,"Net Unit Cost "),e.qZA(),e.TgZ(57,"th",23),e._uU(58,"Quantity"),e.qZA(),e.TgZ(59,"th",23),e._uU(60,"Tax"),e.qZA(),e.TgZ(61,"th",23),e._uU(62,"SubTotal"),e.qZA(),e._UZ(63,"th"),e.qZA(),e.qZA(),e.TgZ(64,"tbody",24),e.YNc(65,Q,17,8,"tr",25),e.qZA(),e.qZA(),e.TgZ(66,"table",26),e.TgZ(67,"tbody",24),e.TgZ(68,"tr"),e.TgZ(69,"td"),e._uU(70,"Order Tax"),e.qZA(),e.TgZ(71,"td"),e._uU(72),e.qZA(),e.qZA(),e.TgZ(73,"tr"),e.TgZ(74,"td"),e._uU(75,"Discount"),e.qZA(),e.TgZ(76,"td"),e._uU(77),e.qZA(),e.qZA(),e.TgZ(78,"tr"),e.TgZ(79,"td"),e._uU(80,"Shipping"),e.qZA(),e.TgZ(81,"td"),e._uU(82),e.qZA(),e.qZA(),e.TgZ(83,"tr"),e.TgZ(84,"td"),e._uU(85,"Grand Total"),e.qZA(),e.TgZ(86,"td"),e._uU(87),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(88,"div",1),e.TgZ(89,"div",2),e.TgZ(90,"label",27),e._uU(91,"Order Tax"),e.qZA(),e.TgZ(92,"div",4),e.TgZ(93,"input",28),e.NdJ("ngModelChange",function(){return t.countOrderTax(),t.countGrandTotal()}),e.qZA(),e.qZA(),e.TgZ(94,"div",7),e.YNc(95,Y,2,1,"small",8),e.qZA(),e.qZA(),e.TgZ(96,"div",2),e.TgZ(97,"label",27),e._uU(98,"Discount"),e.qZA(),e.TgZ(99,"div",4),e.TgZ(100,"input",29),e.NdJ("ngModelChange",function(){return t.countDiscount(),t.countGrandTotal()}),e.qZA(),e.qZA(),e.TgZ(101,"div",7),e.YNc(102,W,2,1,"small",8),e.qZA(),e.qZA(),e.TgZ(103,"div",2),e.TgZ(104,"label",27),e._uU(105,"Shipping"),e.qZA(),e.TgZ(106,"div",4),e.TgZ(107,"input",30),e.NdJ("ngModelChange",function(){return t.countShipping(),t.countGrandTotal()}),e.qZA(),e.qZA(),e.TgZ(108,"div",7),e.YNc(109,G,2,1,"small",8),e.qZA(),e.qZA(),e.TgZ(110,"div",2),e.TgZ(111,"label",31),e._uU(112,"Status"),e.qZA(),e.TgZ(113,"div",4),e.TgZ(114,"select",32),e.TgZ(115,"option",11),e._uU(116,"Completed"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(117,"div",33),e.TgZ(118,"div",34),e.TgZ(119,"label",35),e._uU(120,"Note"),e.qZA(),e._UZ(121,"textarea",36),e.qZA(),e.qZA(),e.TgZ(122,"div",34),e.TgZ(123,"div",37),e.TgZ(124,"button",38),e.NdJ("click",function(){return t.passMe()}),e._uU(125,"Submit"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&r&&(e.xp6(4),e.Q6J("formGroup",t.createPurchForm),e.xp6(7),e.Q6J("ngIf",t.createPurchForm.controls.date.touched&&t.createPurchForm.controls.date.invalid||t.submitted&&t.createPurchForm.controls.date.invalid),e.xp6(2),e.Q6J("ngIf",null==t.errors?null:t.errors.date),e.xp6(8),e.Q6J("ngForOf",t.suppliers),e.xp6(1),e.Q6J("ngIf",t.createPurchForm.controls.supplier_id.touched&&t.createPurchForm.controls.supplier_id.invalid||t.submitted&&t.createPurchForm.controls.supplier_id.invalid),e.xp6(2),e.Q6J("ngIf",null==t.errors?null:t.errors.supplier_id),e.xp6(8),e.Q6J("ngForOf",t.warehouses),e.xp6(1),e.Q6J("ngIf",t.createPurchForm.controls.warehouse_id.touched&&t.createPurchForm.controls.warehouse_id.invalid||t.submitted&&t.createPurchForm.controls.warehouse_id.invalid),e.xp6(2),e.Q6J("ngIf",null==t.errors?null:t.errors.warehouse_id),e.xp6(6),e.Q6J("size",30),e.xp6(1),e.Q6J("ngModel",t.searchInput)("ngModelOptions",e.DdM(22,j)),e.xp6(3),e.Q6J("ngForOf",t.products),e.xp6(20),e.Q6J("ngForOf",t.purchDetails),e.xp6(7),e.AsE("(%",t.createPurchForm.value.tax_rate,") ",t.orderTax," \u0631\u064a\u0627\u0644"),e.xp6(5),e.hij("",t.discount," \u0631\u064a\u0627\u0644"),e.xp6(5),e.hij("",t.shipping," \u0631\u064a\u0627\u0644"),e.xp6(5),e.Oqu(t.grandTotal),e.xp6(8),e.Q6J("ngIf",null==t.errors?null:t.errors.tax_rate),e.xp6(7),e.Q6J("ngIf",null==t.errors?null:t.errors.discount),e.xp6(7),e.Q6J("ngIf",null==t.errors?null:t.errors.shipping))},directives:[i._Y,i.JL,i.sg,i.Fj,i.JJ,i.u,g.O5,i.EJ,i.YN,i.Kr,g.sg,i.F,b.R,i.On,i.wV,i.Q7,U.d],styles:["body[_ngcontent-%COMP%]{background:white;border-radius:20px;padding:20px}select[_ngcontent-%COMP%]{border-radius:5px;padding:7px;border:1px gainsboro solid}.icon[_ngcontent-%COMP%]{padding-left:10px;padding-top:6px;text-align:center}table[_ngcontent-%COMP%]{margin-top:20px;margin-left:25px;text-align:center;border-radius:10px}ul[_ngcontent-%COMP%]{list-style:none;margin:0 -82px 0 auto;text-align:left}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:5px;overflow:hidden}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:bold;padding-top:7px}.list-group[_ngcontent-%COMP%]{max-height:100px;margin-bottom:10px;overflow:scroll;overflow-x:hidden;-webkit-overflow-scrolling:touch}"]}),o}(),L=s(4677),K=[{path:"",component:B,data:{animation:"sample"}}],R=function(){var o=(0,f.Z)(function a(){(0,C.Z)(this,a)});return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[T.Bz.forChild(K),A.aw,q.$,L.D]]}),o}()}}]);