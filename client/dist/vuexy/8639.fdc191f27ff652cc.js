"use strict";(self.webpackChunkvuexy=self.webpackChunkvuexy||[]).push([[8639],{9010:function(C,T,u){u.d(T,{q:function(){return P}});var f=u(5134),A=u(7289),a=u(4522),t=u(8260),v=u(540),q=u(2047),x=u(6154),P=function(){var g=function(){function m(d){(0,f.Z)(this,m),this._http=d,this.wareData={data:""},this.host=t.N.apiUrl+"/api/warehouses/",this.header=new a.WM({Accept:"application/json"}),this.params=new a.LE}return(0,A.Z)(m,[{key:"AddWare",value:function(p){return this._http.post("".concat(this.host),p,{headers:this.header}).pipe((0,q.K)(function(Z){return console.log(Z),(0,v._)(Z)}))}},{key:"allware",value:function(){return this._http.get("".concat(this.host),{headers:this.header,params:this.params})}},{key:"deleteWare",value:function(p){return this._http.delete("".concat(this.host).concat(p))}},{key:"updateWare",value:function(p,Z){return this._http.patch("".concat(this.host).concat(p),Z)}},{key:"getWareid",value:function(p){return this._http.get("".concat(this.host).concat(p))}}]),m}();return g.\u0275fac=function(d){return new(d||g)(x.LFG(a.eN))},g.\u0275prov=x.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g}()},8639:function(C,T,u){u.r(T),u.d(T,{PurchasesupdateModule:function(){return K}});var f=u(7289),A=u(5134),a=u(9133),t=u(6154),v=u(3907),q=u(3797),x=u(1948),P=u(9010),g=u(1285),m=u(8452),d=u(6019),p=u(9850),Z=u(6533);function b(o,i){1&o&&(t.TgZ(0,"small"),t._uU(1," This field is required "),t.qZA())}function U(o,i){if(1&o&&(t.TgZ(0,"div",39),t.YNc(1,b,2,0,"small",8),t.qZA()),2&o){var r=t.oxw();t.xp6(1),t.Q6J("ngIf",null==r.editPurchForm.controls.date.errors?null:r.editPurchForm.controls.date.errors.required)}}function y(o,i){if(1&o&&(t.TgZ(0,"small"),t._uU(1),t.qZA()),2&o){var r=t.oxw();t.xp6(1),t.Oqu(null==r.errors?null:r.errors.date)}}function O(o,i){if(1&o&&(t.TgZ(0,"option",40),t._uU(1),t.qZA()),2&o){var r=i.$implicit;t.Q6J("value",r.id),t.xp6(1),t.hij(" ",r.name," ")}}function M(o,i){1&o&&(t.TgZ(0,"small"),t._uU(1," This field is required "),t.qZA())}function F(o,i){if(1&o&&(t.TgZ(0,"div",39),t.YNc(1,M,2,0,"small",8),t.qZA()),2&o){var r=t.oxw();t.xp6(1),t.Q6J("ngIf",null==r.editPurchForm.controls.supplier_id.errors?null:r.editPurchForm.controls.supplier_id.errors.required)}}function N(o,i){if(1&o&&(t.TgZ(0,"small"),t._uU(1),t.qZA()),2&o){var r=t.oxw();t.xp6(1),t.Oqu(null==r.errors?null:r.errors.supplier_id)}}function S(o,i){if(1&o&&(t.TgZ(0,"option",40),t._uU(1),t.qZA()),2&o){var r=i.$implicit;t.Q6J("value",r.id),t.xp6(1),t.hij(" ",r.name," ")}}function w(o,i){1&o&&(t.TgZ(0,"small"),t._uU(1," This field is required "),t.qZA())}function I(o,i){if(1&o&&(t.TgZ(0,"div",39),t.YNc(1,w,2,0,"small",8),t.qZA()),2&o){var r=t.oxw();t.xp6(1),t.Q6J("ngIf",null==r.editPurchForm.controls.warehouse_id.errors?null:r.editPurchForm.controls.warehouse_id.errors.required)}}function J(o,i){if(1&o&&(t.TgZ(0,"small"),t._uU(1),t.qZA()),2&o){var r=t.oxw();t.xp6(1),t.Oqu(null==r.errors?null:r.errors.warehouse_id)}}function D(o,i){if(1&o){var r=t.EpF();t.TgZ(0,"li",41),t.NdJ("click",function(){var c=t.CHM(r).index;return t.oxw().addPurchDetail(c)}),t._uU(1),t.qZA()}if(2&o){var e=i.$implicit;t.xp6(1),t.hij(" ",e.name," ")}}function E(o,i){if(1&o){var r=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t.TgZ(8,"core-touchspin",42),t.NdJ("onChange",function(l){var _=t.CHM(r).index;return t.oxw().countChange(l,_)}),t.qZA(),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t.TgZ(14,"div",37),t.TgZ(15,"button",43),t.NdJ("click",function(){var h=t.CHM(r).index;return t.oxw().removePurchDetail(h)}),t._UZ(16,"i",44),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){var e=i.$implicit,n=i.index,s=t.oxw();t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(e.product.name),t.xp6(2),t.Oqu(e.product.cost),t.xp6(2),t.Q6J("minValue",1)("numberValue",e.quantity),t.xp6(2),t.Oqu(s.countTax(e.quantity,e.product.tax_cost)),t.xp6(2),t.Oqu(e.total),t.xp6(4),t.Q6J("size",24)}}function k(o,i){if(1&o&&(t.TgZ(0,"small"),t._uU(1),t.qZA()),2&o){var r=t.oxw();t.xp6(1),t.Oqu(null==r.errors?null:r.errors.tax_rate)}}function W(o,i){if(1&o&&(t.TgZ(0,"small"),t._uU(1),t.qZA()),2&o){var r=t.oxw();t.xp6(1),t.Oqu(null==r.errors?null:r.errors.discount)}}function Y(o,i){if(1&o&&(t.TgZ(0,"small"),t._uU(1),t.qZA()),2&o){var r=t.oxw();t.xp6(1),t.Oqu(null==r.errors?null:r.errors.shipping)}}var Q=function(){return{standalone:!0}},G=function(){var o=function(){function i(r,e,n,s,c,l,h){(0,A.Z)(this,i),this._activatedRoute=r,this._route=e,this._purchaseService=n,this._productSearchService=s,this._warehouseService=c,this._supplierService=l,this._toastr=h,this.searchInput="",this.errors={},this.submitted=!1,this.id=0,this.orderTax=0,this.discount=0,this.shipping=0,this.total=0,this.grandTotal=0,this.wannaPass=!1,this.purchDetails=[],this.editPurchForm=new a.cw({date:new a.NI("",a.kI.required),supplier_id:new a.NI(null,a.kI.required),warehouse_id:new a.NI(null,a.kI.required),shipping:new a.NI(0),tax_rate:new a.NI(0),discount:new a.NI(0),status:new a.NI("PAID"),notes:new a.NI("")})}return(0,f.Z)(i,[{key:"ngOnInit",value:function(){this.getSuppliers(),this.getWarehouses(),this.id=+this._activatedRoute.snapshot.paramMap.get("id"),this.edit(this.id)}},{key:"getWarehouses",value:function(){var e=this;this._warehouseService.allware().subscribe({next:function(s){e.warehouses=s.data}})}},{key:"getSuppliers",value:function(){var e=this;this._supplierService.allSupplier().subscribe({next:function(s){e.suppliers=s.data}})}},{key:"edit",value:function(e){var n=this,s={next:function(l){n.purchase=l.data,n.purchDetails=l.data.purchaseDetails,n.editPurchForm.get("date").setValue(n.purchase.date),n.editPurchForm.get("tax_rate").setValue(n.purchase.tax_rate),n.editPurchForm.get("discount").setValue(n.purchase.discount),n.editPurchForm.get("shipping").setValue(n.purchase.shipping),n.editPurchForm.get("notes").setValue(n.purchase.notes),n.editPurchForm.get("warehouse_id").setValue(n.purchase.warehouse.id),n.editPurchForm.get("supplier_id").setValue(n.purchase.provider.id),n.countTotal(),n.countGrandTotal()}};this._purchaseService.show(e).subscribe(s)}},{key:"updatePurch",value:function(){var e=this;if(this.submitted=!0,0!=this.purchDetails.length){if(this.editPurchForm.valid&&this.wannaPass){var n=this.editPurchForm.value,s=JSON.parse(localStorage.getItem("currentUser"));this.countGrandTotal();var l={next:function(_){e._toastr.success("purchase has been updated"),e._route.navigate(["purchaseslist"])},error:function(_){e.errors=_.error.errors,e._toastr.error("Make sure for your data!")}};this._purchaseService.update(this.id,{date:n.date,discount:n.discount,tax_rate:n.tax_rate,notes:n.notes,shipping:n.shipping,status:n.status,GrandTotal:this.grandTotal,paid_amount:313,warehouse_id:n.warehouse_id,provider_id:n.supplier_id,user_id:s.id,purchaseDetails:this.purchDetails}).subscribe(l)}}else this._toastr.error("please choase product!","Error")}},{key:"purchaseSearch",value:function(e){var n=this;this._productSearchService.purchaseSearch(e).subscribe({next:function(c){n.products=c.data}})}},{key:"addPurchDetail",value:function(e){var n=this;if(this.checkProductExist(this.purchDetails,this.products[e])){var c=this.purchDetails.findIndex(function(h){return h.product.id==n.products[e].id}),l=this.purchDetails[c];l.quantity++,l.total=this.countSubTotal(l.quantity,l.product.tax_cost,l.product.cost)}else{var s={product_id:this.products[e].id,quantity:1,purchase_unit_id:this.products[e].unitPurchase.id,cost:this.products[e].total_cost,total:this.countSubTotal(1,this.products[e].tax_cost,this.products[e].cost),TaxNet:this.products[e].tax_percent,tax_method:this.products[e].tax_method,product:this.products[e]};this.purchDetails.push(s)}this.countTotal(),this.countGrandTotal()}},{key:"removePurchDetail",value:function(e){this.purchDetails.splice(e,1),this.countTotal(),this.countGrandTotal()}},{key:"checkProductExist",value:function(e,n){return e.find(function(s){return s.product.id===n.id})}},{key:"countChange",value:function(e,n){this.purchDetails[n].quantity=e,this.purchDetails[n].total=this.countSubTotal(this.purchDetails[n].quantity,this.purchDetails[n].product.tax_cost,this.purchDetails[n].product.cost),this.countTotal(),this.countGrandTotal()}},{key:"countTax",value:function(e,n){return e*n}},{key:"countSubTotal",value:function(e,n,s){return e*s+this.countTax(e,n)}},{key:"countOrderTax",value:function(){this.orderTax=this.total/100*this.editPurchForm.value.tax_rate}},{key:"countDiscount",value:function(){this.discount=this.editPurchForm.value.discount}},{key:"countShipping",value:function(){this.shipping=this.editPurchForm.value.shipping}},{key:"countGrandTotal",value:function(){this.grandTotal=+this.total+ +this.orderTax+ +this.shipping-+this.discount}},{key:"countTotal",value:function(){var e=this;this.total=0,this.purchDetails.forEach(function(n){e.total+=n.total}),this.countOrderTax(),this.countDiscount(),this.countShipping()}},{key:"passMe",value:function(){this.wannaPass=!0}}]),i}();return o.\u0275fac=function(r){return new(r||o)(t.Y36(v.gz),t.Y36(v.F0),t.Y36(q.B),t.Y36(x.j),t.Y36(P.q),t.Y36(g.k),t.Y36(m._W))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-purchasesupdate"]],decls:126,vars:23,consts:[["action","",3,"formGroup","ngSubmit"],[1,"col-md-12","row"],[1,"form-group","col-md-4"],["for","category",1,"col-md-4","control-label"],[1,"col-md-12"],["formControlName","date","type","date","placeholder","Date","aria-label","Date",1,"form-control","form-control","col-md-11"],["id","","class","form-text text-danger",4,"ngIf"],[1,"form-text","text-danger"],[4,"ngIf"],["for","supplier",1,"col-md-8","control-label"],["aria-label","Default select example","formControlName","supplier_id",1,"form-select","col-md-12"],["selected",""],[3,"value",4,"ngFor","ngForOf"],["for","category",1,"col-md-8","control-label"],["aria-label","Default select example","formControlName","warehouse_id",1,"form-select","col-md-12"],["for","product",1,"col-md-4","control-label"],[1,"col-md-12","mb-1","row","panel","panel-primary"],[1,"switch-icon-left","col-md-1"],["data-feather","search",3,"size"],["type","text","placeholder","Search By product name or variants","aria-label","Search",1,"form-control","col-md-11","text-left",3,"ngModel","ngModelOptions","ngModelChange"],[1,"col-md-12","list-group"],["class","list-group-item","style","list-style: none; cursor: pointer;",3,"click",4,"ngFor","ngForOf"],[1,"table","col-md-11"],["scope","col"],[1,"table-group-divider"],[4,"ngFor","ngForOf"],[1,"table","col-md-4","tab"],["for","ordertax",1,"col-md-8","control-label"],["id","ordertax","formControlName","tax_rate","placeholder","0","required","","type","number",1,"form-control","input-md",3,"ngModelChange"],["id","ordertax","formControlName","discount","placeholder","0","required","","type","number",1,"form-control","input-md",3,"ngModelChange"],["id","ordertax","formControlName","shipping","placeholder","0","required","","type","number",1,"form-control","input-md",3,"ngModelChange"],["for","status",1,"col-md-8","control-label"],["aria-label","Default select example","formControlName","status",1,"form-select","col-md-12"],[1,"container"],[1,"form-group","col-md-12"],["for","exampleFormControlTextarea1",1,"form-label"],["id","exampleFormControlTextarea1","rows","3","formControlName","notes",1,"form-control"],[1,"col-md-4"],["id","singlebutton","name","singlebutton",1,"btn","btn-primary",3,"click"],["id","",1,"form-text","text-danger"],[3,"value"],[1,"list-group-item",2,"list-style","none","cursor","pointer",3,"click"],[3,"minValue","numberValue","onChange"],[1,"btn","btn-sm","btn-danger",3,"click"],["data-feather","x-circle",3,"size"]],template:function(r,e){1&r&&(t.TgZ(0,"body"),t.TgZ(1,"h2"),t._uU(2,"Edit Purchase "),t.qZA(),t._UZ(3,"hr"),t.TgZ(4,"form",0),t.NdJ("ngSubmit",function(){return e.updatePurch()}),t.TgZ(5,"div",1),t.TgZ(6,"div",2),t.TgZ(7,"label",3),t._uU(8,"Date"),t.qZA(),t.TgZ(9,"div",4),t._UZ(10,"input",5),t.YNc(11,U,2,1,"div",6),t.TgZ(12,"div",7),t.YNc(13,y,2,1,"small",8),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"div",2),t.TgZ(15,"label",9),t._uU(16,"Supplier"),t.qZA(),t.TgZ(17,"div",4),t.TgZ(18,"select",10),t.TgZ(19,"option",11),t._uU(20,"Choose Supplier"),t.qZA(),t.YNc(21,O,2,2,"option",12),t.qZA(),t.YNc(22,F,2,1,"div",6),t.TgZ(23,"div",7),t.YNc(24,N,2,1,"small",8),t.qZA(),t.qZA(),t.qZA(),t.TgZ(25,"div",2),t.TgZ(26,"label",13),t._uU(27," Warehouse"),t.qZA(),t.TgZ(28,"div",4),t.TgZ(29,"select",14),t.TgZ(30,"option",11),t._uU(31,"Choose Warehouse"),t.qZA(),t.YNc(32,S,2,2,"option",12),t.qZA(),t.YNc(33,I,2,1,"div",6),t.TgZ(34,"div",7),t.YNc(35,J,2,1,"small",8),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(36,"div",4),t.TgZ(37,"label",15),t._uU(38,"Product"),t.qZA(),t.TgZ(39,"form",16),t.TgZ(40,"span",17),t._UZ(41,"i",18),t.qZA(),t.TgZ(42,"input",19),t.NdJ("ngModelChange",function(s){return e.purchaseSearch(s)}),t.qZA(),t.TgZ(43,"div",20),t.TgZ(44,"ul",4),t.YNc(45,D,2,1,"li",21),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(46,"h4"),t._uU(47,"Order items"),t.qZA(),t.TgZ(48,"table",22),t.TgZ(49,"thead"),t.TgZ(50,"tr"),t.TgZ(51,"th",23),t._uU(52,"#"),t.qZA(),t.TgZ(53,"th",23),t._uU(54,"Product"),t.qZA(),t.TgZ(55,"th",23),t._uU(56,"Net Unit Cost "),t.qZA(),t.TgZ(57,"th",23),t._uU(58,"Quantity"),t.qZA(),t.TgZ(59,"th",23),t._uU(60,"Tax"),t.qZA(),t.TgZ(61,"th",23),t._uU(62,"SubTotal"),t.qZA(),t._UZ(63,"th"),t.qZA(),t.qZA(),t.TgZ(64,"tbody",24),t.YNc(65,E,17,8,"tr",25),t.qZA(),t.qZA(),t.TgZ(66,"table",26),t.TgZ(67,"tbody",24),t.TgZ(68,"tr"),t.TgZ(69,"td"),t._uU(70,"Order Tax"),t.qZA(),t.TgZ(71,"td"),t._uU(72),t.qZA(),t.qZA(),t.TgZ(73,"tr"),t.TgZ(74,"td"),t._uU(75,"Discount"),t.qZA(),t.TgZ(76,"td"),t._uU(77),t.qZA(),t.qZA(),t.TgZ(78,"tr"),t.TgZ(79,"td"),t._uU(80,"Shipping"),t.qZA(),t.TgZ(81,"td"),t._uU(82),t.qZA(),t.qZA(),t.TgZ(83,"tr"),t.TgZ(84,"td"),t._uU(85,"Grand Total"),t.qZA(),t.TgZ(86,"td"),t._uU(87),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(88,"div",1),t.TgZ(89,"div",2),t.TgZ(90,"label",27),t._uU(91,"Order Tax"),t.qZA(),t.TgZ(92,"div",4),t.TgZ(93,"input",28),t.NdJ("ngModelChange",function(){return e.countOrderTax(),e.countGrandTotal()}),t.qZA(),t.qZA(),t.TgZ(94,"div",7),t.YNc(95,k,2,1,"small",8),t.qZA(),t.qZA(),t.TgZ(96,"div",2),t.TgZ(97,"label",27),t._uU(98,"Discount"),t.qZA(),t.TgZ(99,"div",4),t.TgZ(100,"input",29),t.NdJ("ngModelChange",function(){return e.countDiscount(),e.countGrandTotal()}),t.qZA(),t.qZA(),t.TgZ(101,"div",7),t.YNc(102,W,2,1,"small",8),t.qZA(),t.qZA(),t.TgZ(103,"div",2),t.TgZ(104,"label",27),t._uU(105,"Shipping"),t.qZA(),t.TgZ(106,"div",4),t.TgZ(107,"input",30),t.NdJ("ngModelChange",function(){return e.countShipping(),e.countGrandTotal()}),t.qZA(),t.qZA(),t.TgZ(108,"div",7),t.YNc(109,Y,2,1,"small",8),t.qZA(),t.qZA(),t.TgZ(110,"div",2),t.TgZ(111,"label",31),t._uU(112,"Status"),t.qZA(),t.TgZ(113,"div",4),t.TgZ(114,"select",32),t.TgZ(115,"option",11),t._uU(116,"Completed"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(117,"div",33),t.TgZ(118,"div",34),t.TgZ(119,"label",35),t._uU(120,"Note"),t.qZA(),t._UZ(121,"textarea",36),t.qZA(),t.qZA(),t.TgZ(122,"div",34),t.TgZ(123,"div",37),t.TgZ(124,"button",38),t.NdJ("click",function(){return e.passMe()}),t._uU(125,"Submit"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&r&&(t.xp6(4),t.Q6J("formGroup",e.editPurchForm),t.xp6(7),t.Q6J("ngIf",e.editPurchForm.controls.date.touched&&e.editPurchForm.controls.date.invalid||e.submitted&&e.editPurchForm.controls.date.invalid),t.xp6(2),t.Q6J("ngIf",null==e.errors?null:e.errors.date),t.xp6(8),t.Q6J("ngForOf",e.suppliers),t.xp6(1),t.Q6J("ngIf",e.editPurchForm.controls.supplier_id.touched&&e.editPurchForm.controls.supplier_id.invalid||e.submitted&&e.editPurchForm.controls.supplier_id.invalid),t.xp6(2),t.Q6J("ngIf",null==e.errors?null:e.errors.supplier_id),t.xp6(8),t.Q6J("ngForOf",e.warehouses),t.xp6(1),t.Q6J("ngIf",e.editPurchForm.controls.warehouse_id.touched&&e.editPurchForm.controls.warehouse_id.invalid||e.submitted&&e.editPurchForm.controls.warehouse_id.invalid),t.xp6(2),t.Q6J("ngIf",null==e.errors?null:e.errors.warehouse_id),t.xp6(6),t.Q6J("size",30),t.xp6(1),t.Q6J("ngModel",e.searchInput)("ngModelOptions",t.DdM(22,Q)),t.xp6(3),t.Q6J("ngForOf",e.products),t.xp6(20),t.Q6J("ngForOf",e.purchDetails),t.xp6(7),t.AsE("(%",e.editPurchForm.value.tax_rate,") ",e.orderTax," \u0631\u064a\u0627\u0644"),t.xp6(5),t.hij("",e.discount," \u0631\u064a\u0627\u0644"),t.xp6(5),t.hij("",e.shipping," \u0631\u064a\u0627\u0644"),t.xp6(5),t.Oqu(e.grandTotal),t.xp6(8),t.Q6J("ngIf",null==e.errors?null:e.errors.tax_rate),t.xp6(7),t.Q6J("ngIf",null==e.errors?null:e.errors.discount),t.xp6(7),t.Q6J("ngIf",null==e.errors?null:e.errors.shipping))},directives:[a._Y,a.JL,a.sg,a.Fj,a.JJ,a.u,d.O5,a.EJ,a.YN,a.Kr,d.sg,a.F,p.R,a.On,a.wV,a.Q7,Z.d],styles:["body[_ngcontent-%COMP%]{background:white;border-radius:20px;padding:20px}select[_ngcontent-%COMP%]{border-radius:5px;padding:7px;border:1px gainsboro solid}.icon[_ngcontent-%COMP%]{padding-left:10px;padding-top:6px;text-align:center}table[_ngcontent-%COMP%]{margin-top:20px;margin-left:25px;text-align:center;border-radius:10px}ul[_ngcontent-%COMP%]{list-style:none;margin:0 -82px 0 auto;text-align:left}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:5px;overflow:hidden}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:bold;padding-top:7px}.list-group[_ngcontent-%COMP%]{max-height:100px;margin-bottom:10px;overflow:scroll;overflow-x:hidden;-webkit-overflow-scrolling:touch}"]}),o}(),V=u(962),j=u(9753),B=u(1705),L=u(4677),R=[{path:"",component:G,data:{animation:"sample"}}],K=function(){var o=(0,f.Z)(function i(){(0,A.Z)(this,i)});return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[v.Bz.forChild(R),j.aw,B.$,V.IJ,L.D]]}),o}()}}]);