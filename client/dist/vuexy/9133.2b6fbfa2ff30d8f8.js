"use strict";(self.webpackChunkvuexy=self.webpackChunkvuexy||[]).push([[9133],{9010:function(S,v,s){s.d(v,{q:function(){return x}});var f=s(5134),C=s(7289),T=s(4522),A=s(8260),q=s(540),l=s(2047),e=s(6154),x=function(){var h=function(){function Z(d){(0,f.Z)(this,Z),this._http=d,this.wareData={data:""},this.host=A.N.apiUrl+"/api/warehouses/",this.header=new T.WM({Accept:"application/json"}),this.params=new T.LE}return(0,C.Z)(Z,[{key:"AddWare",value:function(p){return this._http.post("".concat(this.host),p,{headers:this.header}).pipe((0,l.K)(function(g){return console.log(g),(0,q._)(g)}))}},{key:"allware",value:function(){return this._http.get("".concat(this.host),{headers:this.header,params:this.params})}},{key:"deleteWare",value:function(p){return this._http.delete("".concat(this.host).concat(p))}},{key:"updateWare",value:function(p,g){return this._http.patch("".concat(this.host).concat(p),g)}},{key:"getWareid",value:function(p){return this._http.get("".concat(this.host).concat(p))}}]),Z}();return h.\u0275fac=function(d){return new(d||h)(e.LFG(T.eN))},h.\u0275prov=e.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h}()},6291:function(S,v,s){s.r(v),s.d(v,{CreatesalesModule:function(){return R}});var f=s(7289),C=s(5134),T=s(3907),A=s(9753),q=s(1705),l=s(9133),e=s(6154),x=s(9010),h=s(8906),Z=s(1948),d=s(8452),p=s(5430),g=s(6019),b=s(9850),U=s(6533);function y(n,r){1&n&&(e.TgZ(0,"small"),e._uU(1," This field is required "),e.qZA())}function M(n,r){if(1&n&&(e.TgZ(0,"div",40),e.YNc(1,y,2,0,"small",8),e.qZA()),2&n){var o=e.oxw();e.xp6(1),e.Q6J("ngIf",null==o.createSaleForm.controls.date.errors?null:o.createSaleForm.controls.date.errors.required)}}function O(n,r){if(1&n&&(e.TgZ(0,"small"),e._uU(1),e.qZA()),2&n){var o=e.oxw();e.xp6(1),e.Oqu(null==o.errors?null:o.errors.date)}}function N(n,r){if(1&n&&(e.TgZ(0,"option",41),e._uU(1),e.qZA()),2&n){var o=r.$implicit;e.Q6J("value",o.id),e.xp6(1),e.hij(" ",o.name," ")}}function w(n,r){1&n&&(e.TgZ(0,"small"),e._uU(1," This field is required "),e.qZA())}function F(n,r){if(1&n&&(e.TgZ(0,"div",40),e.YNc(1,w,2,0,"small",8),e.qZA()),2&n){var o=e.oxw();e.xp6(1),e.Q6J("ngIf",null==o.createSaleForm.controls.client.errors?null:o.createSaleForm.controls.client.errors.required)}}function I(n,r){if(1&n&&(e.TgZ(0,"small"),e._uU(1),e.qZA()),2&n){var o=e.oxw();e.xp6(1),e.Oqu(null==o.errors?null:o.errors.client)}}function J(n,r){if(1&n&&(e.TgZ(0,"option",41),e._uU(1),e.qZA()),2&n){var o=r.$implicit;e.Q6J("value",o.id),e.xp6(1),e.hij(" ",o.name," ")}}function P(n,r){1&n&&(e.TgZ(0,"small"),e._uU(1," This field is required "),e.qZA())}function k(n,r){if(1&n&&(e.TgZ(0,"div",40),e.YNc(1,P,2,0,"small",8),e.qZA()),2&n){var o=e.oxw();e.xp6(1),e.Q6J("ngIf",null==o.createSaleForm.controls.warehouse.errors?null:o.createSaleForm.controls.warehouse.errors.required)}}function D(n,r){if(1&n&&(e.TgZ(0,"small"),e._uU(1),e.qZA()),2&n){var o=e.oxw();e.xp6(1),e.Oqu(null==o.errors?null:o.errors.warehouse)}}function E(n,r){if(1&n){var o=e.EpF();e.TgZ(0,"li",42),e.NdJ("click",function(){var c=e.CHM(o).index;return e.oxw().addSaleDetail(c)}),e.TgZ(1,"p"),e._uU(2),e.qZA(),e.qZA()}if(2&n){var t=r.$implicit;e.xp6(2),e.Oqu(t.name)}}function Q(n,r){if(1&n){var o=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e.TgZ(10,"core-touchspin",43),e.NdJ("onChange",function(u){var _=e.CHM(o).index;return e.oxw().countChange(u,_)}),e.qZA(),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td"),e.TgZ(16,"div",38),e.TgZ(17,"button",44),e.NdJ("click",function(){var m=e.CHM(o).index;return e.oxw().removeSaleDetail(m)}),e._UZ(18,"i",45),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&n){var t=r.$implicit,a=r.index,i=e.oxw();e.xp6(2),e.Oqu(a+1),e.xp6(2),e.Oqu(t.product.name),e.xp6(2),e.Oqu(t.product.cost),e.xp6(2),e.Oqu(t.product.in_stock),e.xp6(2),e.Q6J("minValue",1)("maxValue",t.product.in_stock)("numberValue",t.quantity),e.xp6(2),e.Oqu(i.countTax(t.quantity,t.product.tax_cost)),e.xp6(2),e.Oqu(t.subtotal),e.xp6(4),e.Q6J("size",24)}}function W(n,r){if(1&n&&(e.TgZ(0,"small"),e._uU(1),e.qZA()),2&n){var o=e.oxw();e.xp6(1),e.Oqu(null==o.errors?null:o.errors.tax_rate)}}function Y(n,r){if(1&n&&(e.TgZ(0,"small"),e._uU(1),e.qZA()),2&n){var o=e.oxw();e.xp6(1),e.Oqu(null==o.errors?null:o.errors.discount)}}function G(n,r){if(1&n&&(e.TgZ(0,"small"),e._uU(1),e.qZA()),2&n){var o=e.oxw();e.xp6(1),e.Oqu(null==o.errors?null:o.errors.shipping)}}var j=function(){return{standalone:!0}},B=function(){var n=function(){function r(o,t,a,i,c){(0,C.Z)(this,r),this._warehouseService=o,this._clientService=t,this._productSearchService=a,this._toastr=i,this._saleService=c,this.searchInput="",this.submitted=!1,this.errors={},this.orderTax=0,this.discount=0,this.shipping=0,this.total=0,this.grandTotal=0,this.wannaPass=!1,this.saleDetails=[],this.createSaleForm=new l.cw({date:new l.NI("",l.kI.required),client:new l.NI(null,l.kI.required),warehouse:new l.NI(null,l.kI.required),shipping:new l.NI(0),tax_rate:new l.NI(0),discount:new l.NI(0),status:new l.NI("Completed"),payment_status:new l.NI("PENDING"),notes:new l.NI("")})}return(0,f.Z)(r,[{key:"ngOnInit",value:function(){var t=this;this._warehouseService.allware().subscribe({next:function(i){t.warehouses=i.data}}),this._clientService.allClient().subscribe({next:function(i){t.clients=i.data}})}},{key:"getWarehous",value:function(t){this.products=[],this.saleDetails=[]}},{key:"salesSearch",value:function(t){var a=this;this.warehouse_id?this._productSearchService.salesSearch(t,this.warehouse_id).subscribe({next:function(c){a.products=c.data,console.log(a.products)}}):this._toastr.error("please choose warehouse")}},{key:"addSaleDetail",value:function(t){var a=this;if(this.checkProductExist(this.saleDetails,this.products[t])){var c=this.saleDetails.findIndex(function(m){return m.product.id==a.products[t].id}),u=this.saleDetails[c];u.quantity++,u.subtotal=this.countSubTotal(u.quantity,u.product.tax_cost,u.product.cost)}else{var i={product_id:this.products[t].id,quantity:1,sale_unit_id:this.products[t].unitSale.id,unit_price:this.products[t].total_price,subtotal:this.countSubTotal(1,this.products[t].tax_cost,this.products[t].cost),tax_percent:this.products[t].tax_percent,tax_method:this.products[t].tax_method,product:this.products[t],discount:0};this.saleDetails.push(i)}this.countTotal(),this.countGrandTotal()}},{key:"removeSaleDetail",value:function(t){this.saleDetails.splice(t,1),this.countTotal(),this.countGrandTotal()}},{key:"checkProductExist",value:function(t,a){return t.find(function(i){return i.product.id===a.id})}},{key:"countChange",value:function(t,a){this.saleDetails[a].quantity=t,this.saleDetails[a].subtotal=this.countSubTotal(this.saleDetails[a].quantity,this.saleDetails[a].product.tax_cost,this.saleDetails[a].product.cost),this.countTotal(),this.countGrandTotal()}},{key:"countTax",value:function(t,a){return t*a}},{key:"countSubTotal",value:function(t,a,i){return t*i+this.countTax(t,a)}},{key:"countOrderTax",value:function(){this.orderTax=this.total/100*this.createSaleForm.value.tax_rate}},{key:"countDiscount",value:function(){this.discount=this.createSaleForm.value.discount}},{key:"countShipping",value:function(){this.shipping=this.createSaleForm.value.shipping}},{key:"countGrandTotal",value:function(){this.grandTotal=+this.total+ +this.orderTax+ +this.shipping-+this.discount}},{key:"countTotal",value:function(){var t=this;this.total=0,this.saleDetails.forEach(function(a){t.total+=a.subtotal}),this.countOrderTax(),this.countDiscount(),this.countShipping()}},{key:"storeSale",value:function(){var t=this;if(this.submitted=!0,0!=this.saleDetails.length){if(this.createSaleForm.valid&&this.wannaPass){var a=this.createSaleForm.value,i=JSON.parse(localStorage.getItem("currentUser")),u={next:function(_){t._toastr.success("New sale done"),t.saleDetails=[],t.createSaleForm.reset(),t.countGrandTotal()},error:function(_){t.errors=_.error.errors,t._toastr.error("Make sure for your data!")}};this._saleService.store({date:a.date,discount:a.discount,tax_rate:a.tax_rate,notes:a.notes,shipping:a.shipping,status:a.status,GrandTotal:this.grandTotal,paid_amount:0,client_id:a.client,user_id:i.id,details:this.saleDetails,payment_status:a.payment_status,due:a.due,warehouse_id:a.warehouse,payment:1}).subscribe(u)}}else this._toastr.error("please choose product!","Error")}},{key:"passMe",value:function(){this.wannaPass=!0}}]),r}();return n.\u0275fac=function(o){return new(o||n)(e.Y36(x.q),e.Y36(h.k),e.Y36(Z.j),e.Y36(d._W),e.Y36(p.F))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-createsales"]],decls:131,vars:24,consts:[["action","",3,"formGroup","ngSubmit"],[1,"col-md-12","row"],[1,"form-group","col-md-4"],["for","category",1,"col-md-4","control-label"],[1,"col-md-12"],["formControlName","date","type","date","placeholder","Date","aria-label","Date",1,"form-control","form-control","col-md-11"],["id","","class","form-text text-danger",4,"ngIf"],[1,"form-text","text-danger"],[4,"ngIf"],["for","customer",1,"col-md-8","control-label"],["formControlName","client","aria-label","Default select example",1,"form-select","col-md-12"],[3,"value",4,"ngFor","ngForOf"],["for","category",1,"col-md-8","control-label"],["formControlName","warehouse","aria-label","Default select example",1,"form-select","col-md-12",3,"ngModel","ngModelChange"],["for","product",1,"col-md-4","control-label"],[1,"col-md-12","mb-1","row","panel","panel-primary"],[1,"switch-icon-left","col-md-1"],["data-feather","search",3,"size"],["type","text","placeholder","Search By product name or variants","aria-label","Search",1,"form-control","col-md-11","text-left",3,"ngModel","ngModelOptions","ngModelChange"],[1,"col-md-12","list-group"],["class","list-group-item","style","list-style: none; cursor: pointer",3,"click",4,"ngFor","ngForOf"],[1,"table","col-md-11"],["scope","col"],["data-feather","x-circle",1,"btn-outline-secondary"],[1,"table-group-divider"],[4,"ngFor","ngForOf"],[1,"table","col-md-4","tab"],["for","ordertax",1,"col-md-8","control-label"],["id","ordertax","formControlName","tax_rate","placeholder","0","required","","type","number",1,"form-control","input-md",3,"ngModelChange"],["id","ordertax","formControlName","discount","placeholder","0","required","","type","number",1,"form-control","input-md",3,"ngModelChange"],["id","ordertax","formControlName","shipping","placeholder","0","required","","type","number",1,"form-control","input-md",3,"ngModelChange"],["for","status",1,"col-md-8","control-label"],["aria-label","Default select example","formControlName","status",1,"form-select","col-md-12"],["selected",""],["aria-label","Default select example","formControlName","payment_status",1,"form-select","col-md-12"],[1,"form-group","col-md-12"],["for","exampleFormControlTextarea1",1,"form-label"],["id","exampleFormControlTextarea1","rows","3","formControlName","notes",1,"form-control"],[1,"col-md-4"],["id","singlebutton","name","singlebutton",1,"btn","btn-primary",3,"click"],["id","",1,"form-text","text-danger"],[3,"value"],[1,"list-group-item",2,"list-style","none","cursor","pointer",3,"click"],[3,"minValue","maxValue","numberValue","onChange"],[1,"btn","btn-sm","btn-danger",3,"click"],["data-feather","x-circle",3,"size"]],template:function(o,t){1&o&&(e.TgZ(0,"body"),e.TgZ(1,"h2"),e._uU(2,"Create Sale"),e.qZA(),e._UZ(3,"hr"),e.TgZ(4,"form",0),e.NdJ("ngSubmit",function(){return t.storeSale()}),e.TgZ(5,"div",1),e.TgZ(6,"div",2),e.TgZ(7,"label",3),e._uU(8,"Date"),e.qZA(),e.TgZ(9,"div",4),e._UZ(10,"input",5),e.YNc(11,M,2,1,"div",6),e.TgZ(12,"div",7),e.YNc(13,O,2,1,"small",8),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div",2),e.TgZ(15,"label",9),e._uU(16,"Customer"),e.qZA(),e.TgZ(17,"div",4),e.TgZ(18,"select",10),e.YNc(19,N,2,2,"option",11),e.qZA(),e.YNc(20,F,2,1,"div",6),e.TgZ(21,"div",7),e.YNc(22,I,2,1,"small",8),e.qZA(),e.qZA(),e.qZA(),e.TgZ(23,"div",2),e.TgZ(24,"label",12),e._uU(25," Warehouse"),e.qZA(),e.TgZ(26,"div",4),e.TgZ(27,"select",13),e.NdJ("ngModelChange",function(i){return t.warehouse_id=i})("ngModelChange",function(i){return t.getWarehous(i)}),e.YNc(28,J,2,2,"option",11),e.qZA(),e.YNc(29,k,2,1,"div",6),e.TgZ(30,"div",7),e.YNc(31,D,2,1,"small",8),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(32,"div",4),e.TgZ(33,"label",14),e._uU(34,"Product"),e.qZA(),e.TgZ(35,"form",15),e.TgZ(36,"span",16),e._UZ(37,"i",17),e.qZA(),e.TgZ(38,"input",18),e.NdJ("ngModelChange",function(i){return t.salesSearch(i)}),e.qZA(),e.TgZ(39,"div",19),e.TgZ(40,"ul",4),e.YNc(41,E,3,1,"li",20),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(42,"h4"),e._uU(43,"Order items"),e.qZA(),e.TgZ(44,"table",21),e.TgZ(45,"thead"),e.TgZ(46,"tr"),e.TgZ(47,"th",22),e._uU(48,"#"),e.qZA(),e.TgZ(49,"th",22),e._uU(50,"Product"),e.qZA(),e.TgZ(51,"th",22),e._uU(52,"Net Unit Code"),e.qZA(),e.TgZ(53,"th",22),e._uU(54,"in Stock"),e.qZA(),e.TgZ(55,"th",22),e._uU(56,"Quantity"),e.qZA(),e.TgZ(57,"th",22),e._uU(58,"Tax"),e.qZA(),e.TgZ(59,"th",22),e._uU(60,"Subtotal"),e.qZA(),e.TgZ(61,"th",22),e._UZ(62,"i",23),e.qZA(),e.qZA(),e.qZA(),e.TgZ(63,"tbody",24),e.YNc(64,Q,19,10,"tr",25),e.qZA(),e.qZA(),e.TgZ(65,"table",26),e.TgZ(66,"tbody",24),e.TgZ(67,"tr"),e.TgZ(68,"td"),e._uU(69,"Order Tax"),e.qZA(),e.TgZ(70,"td"),e._uU(71),e.qZA(),e.qZA(),e.TgZ(72,"tr"),e.TgZ(73,"td"),e._uU(74,"Discount"),e.qZA(),e.TgZ(75,"td"),e._uU(76),e.qZA(),e.qZA(),e.TgZ(77,"tr"),e.TgZ(78,"td"),e._uU(79,"Shipping"),e.qZA(),e.TgZ(80,"td"),e._uU(81),e.qZA(),e.qZA(),e.TgZ(82,"tr"),e.TgZ(83,"td"),e._uU(84,"Grand Total"),e.qZA(),e.TgZ(85,"td"),e._uU(86),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(87,"div",1),e.TgZ(88,"div",2),e.TgZ(89,"label",27),e._uU(90,"Order Tax"),e.qZA(),e.TgZ(91,"div",4),e.TgZ(92,"input",28),e.NdJ("ngModelChange",function(){return t.countOrderTax(),t.countGrandTotal()}),e.qZA(),e.qZA(),e.TgZ(93,"div",7),e.YNc(94,W,2,1,"small",8),e.qZA(),e.qZA(),e.TgZ(95,"div",2),e.TgZ(96,"label",27),e._uU(97,"Discount"),e.qZA(),e.TgZ(98,"div",4),e.TgZ(99,"input",29),e.NdJ("ngModelChange",function(){return t.countDiscount(),t.countGrandTotal()}),e.qZA(),e.qZA(),e.TgZ(100,"div",7),e.YNc(101,Y,2,1,"small",8),e.qZA(),e.qZA(),e.TgZ(102,"div",2),e.TgZ(103,"label",27),e._uU(104,"Shipping"),e.qZA(),e.TgZ(105,"div",4),e.TgZ(106,"input",30),e.NdJ("ngModelChange",function(){return t.countShipping(),t.countGrandTotal()}),e.qZA(),e.qZA(),e.TgZ(107,"div",7),e.YNc(108,G,2,1,"small",8),e.qZA(),e.qZA(),e.TgZ(109,"div",2),e.TgZ(110,"label",31),e._uU(111,"Status"),e.qZA(),e.TgZ(112,"div",4),e.TgZ(113,"select",32),e.TgZ(114,"option",33),e._uU(115,"Completed"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(116,"div",2),e.TgZ(117,"label",31),e._uU(118,"Payment Status"),e.qZA(),e.TgZ(119,"div",4),e.TgZ(120,"select",34),e.TgZ(121,"option",33),e._uU(122,"Pending"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(123,"div",35),e.TgZ(124,"label",36),e._uU(125,"Note"),e.qZA(),e._UZ(126,"textarea",37),e.qZA(),e.TgZ(127,"div",35),e.TgZ(128,"div",38),e.TgZ(129,"button",39),e.NdJ("click",function(){return t.passMe()}),e._uU(130," Submit "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(4),e.Q6J("formGroup",t.createSaleForm),e.xp6(7),e.Q6J("ngIf",t.createSaleForm.controls.date.touched&&t.createSaleForm.controls.date.invalid||t.submitted&&t.createSaleForm.controls.date.invalid),e.xp6(2),e.Q6J("ngIf",null==t.errors?null:t.errors.date),e.xp6(6),e.Q6J("ngForOf",t.clients),e.xp6(1),e.Q6J("ngIf",t.createSaleForm.controls.client.touched&&t.createSaleForm.controls.client.invalid||t.submitted&&t.createSaleForm.controls.client.invalid),e.xp6(2),e.Q6J("ngIf",null==t.errors?null:t.errors.client),e.xp6(5),e.Q6J("ngModel",t.warehouse_id),e.xp6(1),e.Q6J("ngForOf",t.warehouses),e.xp6(1),e.Q6J("ngIf",t.createSaleForm.controls.warehouse.touched&&t.createSaleForm.controls.warehouse.invalid||t.submitted&&t.createSaleForm.controls.warehouse.invalid),e.xp6(2),e.Q6J("ngIf",null==t.errors?null:t.errors.warehouse),e.xp6(6),e.Q6J("size",30),e.xp6(1),e.Q6J("ngModel",t.searchInput)("ngModelOptions",e.DdM(23,j)),e.xp6(3),e.Q6J("ngForOf",t.products),e.xp6(23),e.Q6J("ngForOf",t.saleDetails),e.xp6(7),e.AsE(" (%",t.createSaleForm.value.tax_rate,") ",t.orderTax," \u0631\u064a\u0627\u0644 "),e.xp6(5),e.hij("",t.discount," \u0631\u064a\u0627\u0644"),e.xp6(5),e.hij("",t.shipping," \u0631\u064a\u0627\u0644"),e.xp6(5),e.Oqu(t.grandTotal),e.xp6(8),e.Q6J("ngIf",null==t.errors?null:t.errors.tax_rate),e.xp6(7),e.Q6J("ngIf",null==t.errors?null:t.errors.discount),e.xp6(7),e.Q6J("ngIf",null==t.errors?null:t.errors.shipping))},directives:[l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u,g.O5,l.EJ,g.sg,l.F,b.R,l.On,l.wV,l.Q7,l.YN,l.Kr,U.d],styles:["body[_ngcontent-%COMP%]{background:white;border-radius:20px;padding:20px}select[_ngcontent-%COMP%]{border-radius:5px;padding:7px;border:1px gainsboro solid}.icon[_ngcontent-%COMP%]{padding-left:10px;padding-top:6px;text-align:center}table[_ngcontent-%COMP%]{margin-top:20px;margin-left:25px;text-align:center;border-radius:10px}ul[_ngcontent-%COMP%]{list-style:none;margin:0 -82px 0 auto;text-align:left}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:5px;overflow:hidden}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:bold;padding-top:7px}.list-group[_ngcontent-%COMP%]{max-height:100px;margin-bottom:10px;overflow:scroll;overflow-x:hidden;-webkit-overflow-scrolling:touch}"]}),n}(),L=s(4677),K=[{path:"",component:B,data:{animation:"sample"}}],R=function(){var n=(0,f.Z)(function r(){(0,C.Z)(this,r)});return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[T.Bz.forChild(K),A.aw,q.$,L.D]]}),n}()}}]);